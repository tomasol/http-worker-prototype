version: '3'

services:
  poller:
    build: .
    command: bash -c "node /http-worker/conductor-poller/start-conductor-poller.js"
    depends_on:
      - worker

  worker:
    build: .
    command: bash -c "node /http-worker/http-worker/httpworker-grpc-server"
    ports:
      - "50051:50051"

  vault:
    image: vault
    volumes:
      - $PWD/vault/:/tmp/vault
    cap_add:
      - IPC_LOCK
    command: server -config /tmp/vault/config.hcl
    ports:
      - "8200:8200"
